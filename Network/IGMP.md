### Introduction

> [!Question] ChatGPT
> **What is the benefit of local multicasting (IGMP) in networking? What's the purpose of having groups?**
>
> Local multicasting, facilitated by the Internet Group Management Protocol (IGMP), offers several benefits in networking, especially for scenarios where efficient and scalable communication is required among a specific group of devices. IGMP is used to manage and control multicast group memberships on a local network segment. The purpose of having multicast groups is to enable targeted communication to a selected set of devices, reducing network congestion and optimizing data transmission. Here are the benefits and purposes of local multicasting and multicast groups:
>
> 1. **Efficient Data Transmission:** Multicasting allows data to be sent from one source to multiple recipients simultaneously, using a single transmission. This contrasts with broadcasting, which sends data to all devices on the network. By transmitting data only to interested recipients (those belonging to the multicast group), network bandwidth is used more efficiently.
>    
> 2. **Reduced Network Load:** Multicasting minimizes the impact on the network infrastructure by delivering data only to devices that are part of the multicast group. This approach helps prevent unnecessary network congestion that would occur with broadcasting or sending data individually to multiple devices.
>    
> 3. **Optimized for Multimedia and Streaming:** Applications such as multimedia streaming and video conferencing benefit from multicasting. These applications require the same data to be delivered to multiple recipients simultaneously, which is efficiently achieved through multicast group communication.
>    
> 4. **Scalability:** Multicast groups are scalable because devices can easily join or leave multicast groups as needed. This flexibility allows networks to handle a varying number of recipients without significant administrative overhead.
>    
> 5. **Real-Time Communication:** Multicasting is often used for real-time communication, such as online gaming, live video streaming, and financial trading systems. These applications require low-latency data delivery, and multicasting ensures that data reaches all interested parties without delay.
>    
> 6. **Reduced Data Replication:** In applications where the same data needs to be replicated to multiple destinations (e.g., software updates), multicasting eliminates the need to send separate copies to each recipient, reducing unnecessary data replication.
>     
> 7. **Group-Specific Services:** Multicast groups allow for targeted delivery of services or content to specific groups of devices. For example, a company might deliver video training content to a specific team or department.
>     
> 8. **Broadcast Domain Isolation:** By using multicast groups, network administrators can isolate multicast traffic to specific segments of the network, preventing it from unnecessarily propagating to areas where it's not needed.

* So far we have discussed how multicast datagrams are transmitted, filtered, and received from a host’s perspective. When multicast datagrams are to be forwarded over a wide area network or within an enterprise across multiple subnets, we require that multicast routing be enabled by one or more multicast routers. This complicates the situation considerably, because multicast routers require knowledge about which hosts are interested in what multicast groups, in order to arrange for multicast traffic to be delivered appropriately.
	* They also execute a special procedure called the Reverse Path Forwarding (RPF) check. This procedure performs a routing lookup on the source address of an arriving multicast datagram. Only if the outgoing interface for routing matches the interface on which the datagram arrived is the datagram forwarded. The RPF check is important for avoiding multicast loops. Multicast routing is largely separate from conventional unicast routing provided by IP routers.
* The major protocol in IPv4 used to allow multicast routers to learn the groups in which the nearby hosts are interested is, The Internet Group Management Protocol (IGMP).
	* It lets the multicast routers on a LAN (VLAN) know which hosts currently belong to which multicast groups. This information is required by the routers so that they know which multicast datagrams to forward on to which interfaces.
		* In most cases, a multicast router only requires knowledge that at least one listening host is reachable by a particular interface, as link-layer multicast addressing (assuming it is supported) permits the multicast router to send link-layer multicast frames that will be received by all interested listeners. This allows a multicast router to do its job without keeping track of every individual host on each interface that might be interested in multicast traffic for a particular group.
* Unlike other protocols so far, IGMP uses TTL=1, so packets are limited to the local subnetwork.
* IGMP defines two sets of protocol processing rules: those performed by hosts that are group members and those performed by multicast routers. Generally speaking, the job of the member hosts (which we will call “group members”) is to spontaneously report changes in interest in multicast groups and sources and to respond to periodic queries. Multicast routers send queries to ascertain whether any interest is present on an attached link for any groups, or for a specific multicast group and source. Routers also interact with wide area multicast protocols (such as PIM-SM and BIDIR-PIM) to bring the desired traffic to the interested hosts or prohibit traffic from flowing to uninterested hosts.

### IGMP Processing by Group Members
* The group members’ portion of IGMP is designed to allow hosts to specify what groups they are interested in and whether traffic sent from particular sources should be accepted or filtered out. This is accomplished by sending reports to one or more multicast routers (and participating hosts) attached to the same subnet. Reports may be sent as a result of receiving a query, or spontaneously (unsolicited) because of a local change in reception state (e.g., an application joins or leaves a group).
* Report messages are fairly simple. They contain a vector of group records, each of which provides information about a particular multicast group, including the address of the subject group, and an optional list of sources used for establishing filters.
* Each group record contains a type, the address of the subject group, and a list of source addresses to either include or exclude. Table 9-1 reveals the significant flexibility that can be achieved using IGMPv3 report record types. A list of sources is said to refer to include mode or exclude mode. In include mode, the sources in the list are the only sources from which traffic should be accepted. In exclude mode, the sources in the list are the ones to be filtered out (all others are allowed). Leaving a group can be expressed as using an include mode filter with no sources, and a simple join of a group (i.e., for any source) can be expressed as using the exclude mode filter with no sources.
* When receiving a query, group members do not respond immediately. Instead, they set a random (bounded) timer to determine when to respond. During this delay interval, processes may alter their group/source interests. Any such modifications can be processed together before a timer expires to trigger the report. In this way, once the timer does expire, the status of multiple groups can more likely be merged into a single report, saving overhead.

### IGMP Processing by Multicast Routers
* In IGMP, the job of the multicast router is to determine, for each multicast group, interface, and source list, whether at least one group member is present to receive corresponding traffic. This is accomplished by sending queries and building state describing the existence of such members based on the reports they send. This state is soft state, meaning that it is cleared after a certain amount of time if not refreshed.
* refer to page 457
* There are three variants of the query message that can be sent by a multicast router: **general query**, **group-specific query**, and **group-and-source-specific query**. The first form is used by the multicast router to update information regarding any multicast group, and for such queries the group list is empty. Group-specific queries are similar to general queries but are specific to the identified group. The last type is essentially a group-specific query with a set of sources included. The specific queries are sent to the destination IP address of the subject group, as opposed to general queries that are sent to the All Systems multicast address.
	* The specific queries are sent in response to state-change reports in order to verify that it is appropriate for the router to take some action (e.g., to ensure that no interest remains in a particular group before constructing a filter). When receiving either filter-mode-change records or source-list-change records, the multicast router arranges to add new traffic sources and may be able to filter out traffic from certain sources. In cases where the multicast router is prepared to begin filtering out traffic that was flowing previously, it uses the group-specific query and group-and-source-specific query first. If these queries elicit no reports, the router is free to begin filtering out the corresponding traffic. Because such changes can significantly affect the flow of multicast traffic, state-change reports and specific queries are retransmitted.

